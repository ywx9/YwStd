/// \file clocale
/// \copyright (c) 2022 ywx9.com

#pragma once

#include "inc/corecrt.h"
#include "inc/yvals_core.h"

#include "ctime"

#if ywstd_is_exported
extern "C" {
#define LC_ALL 0
#define LC_COLLATE 1
#define LC_CTYPE 2
#define LC_MONETARY 3
#define LC_NUMERIC 4
#define LC_TIME 5
#define LC_MIN LC_ALL
#define LC_MAX LC_TIME

struct lconv {
  char* decimal_point;
  char* thousands_sep;
  char* grouping;
  char* int_curr_symbol;
  char* currency_symbol;
  char* mon_decimal_point;
  char* mon_thousands_sep;
  char* mon_grouping;
  char* positive_sign;
  char* negative_sign;
  char int_frac_digits;
  char frac_digits;
  char p_cs_precedes;
  char p_sep_by_space;
  char n_cs_precedes;
  char n_sep_by_space;
  char p_sign_posn;
  char n_sign_posn;
  wchar_t* _W_decimal_point;
  wchar_t* _W_thousands_sep;
  wchar_t* _W_int_curr_symbol;
  wchar_t* _W_currency_symbol;
  wchar_t* _W_mon_decimal_point;
  wchar_t* _W_mon_thousands_sep;
  wchar_t* _W_positive_sign;
  wchar_t* _W_negative_sign;
};

#ifdef _CHAR_UNSIGNED
extern int __do_unsigned_char_lconv_initialization;
extern inline int __use_char_max(void) { return __do_unsigned_char_lconv_initialization; }
#endif

#define _ENABLE_PER_THREAD_LOCALE 0x0001
#define _DISABLE_PER_THREAD_LOCALE 0x0002
#define _ENABLE_PER_THREAD_LOCALE_GLOBAL 0x0010
#define _DISABLE_PER_THREAD_LOCALE_GLOBAL 0x0020
#define _ENABLE_PER_THREAD_LOCALE_NEW 0x0100
#define _DISABLE_PER_THREAD_LOCALE_NEW 0x0200

#if _CRT_FUNCTIONS_REQUIRED
_ACRTIMP void __cdecl _lock_locales();
_ACRTIMP void __cdecl _unlock_locales();
_ACRTIMP int __cdecl _configthreadlocale(int);
_ACRTIMP char* __cdecl setlocale(int, const char*);
_ACRTIMP lconv* __cdecl localeconv();
_ACRTIMP _locale_t __cdecl _get_current_locale();
_ACRTIMP _locale_t __cdecl _create_locale(int, const char*);
_ACRTIMP void __cdecl _free_locale(_locale_t);
_ACRTIMP wchar_t* __cdecl _wsetlocale(int, const wchar_t*);
_ACRTIMP _locale_t __cdecl _wcreate_locale(int, const wchar_t*);
_ACRTIMP wchar_t** __cdecl ___lc_locale_name_func();
_ACRTIMP unsigned int __cdecl ___lc_codepage_func();
_ACRTIMP unsigned int __cdecl ___lc_collate_cp_func();
_ACRTIMP char* __cdecl _Getdays();
_ACRTIMP char* __cdecl _Getmonths();
_ACRTIMP void* __cdecl _Gettnames();
_ACRTIMP wchar_t* __cdecl _W_Getdays();
_ACRTIMP wchar_t* __cdecl _W_Getmonths();
_ACRTIMP void* __cdecl _W_Gettnames();
_ACRTIMP size_t __cdecl _Strftime(char*, size_t, const char*, const tm*, void*);
_ACRTIMP size_t __cdecl _Wcsftime(wchar_t*, size_t, const wchar_t*, const tm*, void*);
#endif
}
#else
#define ywstd_export
#endif

#ifndef ywstd_import
extern "C" {
struct lconv;
}
namespace std {
ywstd_export inline lconv* __cdecl localeconv() { return ::localeconv(); }
ywstd_export inline char* __cdecl setlocale(int category, const char* locale) { return ::setlocale(category, locale); }
}
#endif
